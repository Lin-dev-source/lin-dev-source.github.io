(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{470:function(e,t,v){"use strict";v.r(t);var _=v(20),r=Object(_.a)({},(function(){var e=this,t=e.$createElement,v=e._self._c||t;return v("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[v("p",[e._v("作为vue.js的开发者，当然要了解源码啦")]),e._v(" "),v("p",[v("em",[e._v("this")]),e._v("._parent.replaceChild(realDOM,document.querySelector( '#root' )) //这里不能用this._template")]),e._v(" "),v("p",[e._v("一个Dep代表一个属性")]),e._v(" "),v("p",[e._v("Dep.target的deps有几个dep就代表全局watcher关联了几个属性")]),e._v(" "),v("p",[e._v("Dep.target是全局watcher，有属性在mount的时候才有值，这个值就是这个属性的watcher")]),e._v(" "),v("p",[e._v("当mount完成后清空Dep.target")]),e._v(" "),v("p",[e._v("依赖收集->哪些属性变更")]),e._v(" "),v("p",[e._v("在defineProperty的get里进行依赖收集（有全局watcher时才进行收集）")]),e._v(" "),v("p",[e._v("将这个watcher放到 subs[] 数组中(这些放到subs的watcher  当全局watcher==null时可调用渲染)")]),e._v(" "),v("p",[e._v("Dep.target.addDep(this) 将当前的Dep放到当前的全局watcher对象的deps[]数组里")]),e._v(" "),v("h3",{attrs:{id:"只要触发getter就会收集依赖吗"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#只要触发getter就会收集依赖吗"}},[e._v("#")]),e._v(" 只要触发getter就会收集依赖吗")]),e._v(" "),v("p",[e._v("答案是否定的。在"),v("code",[e._v("Dep")]),e._v("的"),v("code",[e._v("depend")]),e._v("方法中，我们看到，只有"),v("code",[e._v("Dep.target")]),e._v("为真时才会添加依赖。比如在派发更新时会触发"),v("code",[e._v("watcher")]),e._v("的"),v("code",[e._v("update")]),e._v("方法，该方法也会触发"),v("code",[e._v("parsePath")]),e._v("来取值，但是此时的"),v("code",[e._v("Dep.target")]),e._v("为"),v("code",[e._v("null")]),e._v("，不会添加依赖。仔细观察可以发现，只有"),v("code",[e._v("watcher")]),e._v("的"),v("code",[e._v("get")]),e._v("方法中会调用"),v("code",[e._v("pushTarget(this)")]),e._v("来对"),v("code",[e._v("Dep.target")]),e._v("赋值，其他时候"),v("code",[e._v("Dep.target")]),e._v("都是"),v("code",[e._v("null")]),e._v("，而"),v("code",[e._v("get")]),e._v("方法只会在实例化"),v("code",[e._v("watcher")]),e._v("的时候调用，因此，在我们的实现中，一个"),v("code",[e._v("watcher")]),e._v("的依赖在其实例化时就已经确定了，之后任何读取值的操作均不会增加依赖。")]),e._v(" "),v("p",[e._v("为什么set的时候会触发这个属性对应的dep呢？？？？")]),e._v(" "),v("ul",[v("li",[e._v("封装def，引入enumerable参数避免死递归")])]),e._v(" "),v("p",[e._v("oberver文件")])])}),[],!1,null,null,null);t.default=r.exports}}]);